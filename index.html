<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Demo Catálogo - Simulación App</title>
<style>
  :root{--bg:#f6f7fb;--card:#fff;--accent:#1a73e8;--muted:#666}
  body{font-family:Inter,system-ui,Segoe UI,Roboto,'Helvetica Neue',Arial;margin:0;background:var(--bg);color:#222}
  .app{max-width:1100px;margin:24px auto;padding:16px}
  header{display:flex;gap:12px;align-items:center;justify-content:space-between;margin-bottom:16px}
  h1{font-size:20px;margin:0}
  .controls{display:flex;gap:12px;flex:1;align-items:center;justify-content:flex-end}
  input.search{padding:10px 12px;border-radius:8px;border:1px solid #ddd;width:320px;box-sizing:border-box}
  select{padding:9px;border-radius:8px;border:1px solid #ddd;background:white}
  .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:14px}
  .card{background:var(--card);border-radius:12px;padding:12px;box-shadow:0 6px 18px rgba(20,20,50,0.06);cursor:pointer;display:flex;flex-direction:column;gap:8px;min-height:160px}
  .thumb{height:100px;background:linear-gradient(135deg,#e9eefc,#fff);border-radius:8px;display:flex;align-items:center;justify-content:center;font-weight:600;color:var(--muted)}
  .meta{display:flex;justify-content:space-between;align-items:center;font-size:13px}
  .cat{padding:4px 8px;border-radius:999px;background:#f0f4ff;color:var(--accent);font-weight:600;font-size:12px}
  .name{font-weight:700}
  /* modal */
  .modal-back{position:fixed;inset:0;background:rgba(0,0,0,0.45);display:none;align-items:center;justify-content:center;padding:18px;z-index:60}
  .modal{width:100%;max-width:720px;background:var(--card);border-radius:14px;padding:18px;box-shadow:0 10px 30px rgba(0,0,0,0.25)}
  .modal .row{display:flex;gap:12px}
  .modal .left{flex:1}
  .modal .right{width:220px}
  .close{border:none;background:none;font-size:18px;cursor:pointer;color:#444}
  .whatsapp-btn{display:inline-block;padding:10px 12px;border-radius:10px;background:#25D366;color:white;text-decoration:none;font-weight:700}
  .small{font-size:13px;color:var(--muted)}
  @media(max-width:720px){.modal .row{flex-direction:column}.controls{flex-direction:column;align-items:stretch}input.search{width:100%}}
</style>
</head>
<body>
  <div class="app">
    <header>
      <h1>Distribuidora - Catálogo (demo)</h1>
      <div class="controls">
        <input class="search" placeholder="Buscar por nombre, código o descripción..." id="searchInput" />
        <select id="categorySelect">
          <option value="">Todas las categorías</option>
        </select>
      </div>
    </header>

    <main>
      <div id="stats" class="small" style="margin-bottom:8px">Mostrando <span id="count">0</span> productos</div>
      <div class="grid" id="grid"></div>
    </main>
  </div>

  <!-- Modal -->
  <div class="modal-back" id="modalBack" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
        <strong id="mTitle">Producto</strong>
        <button class="close" id="closeModal">✕</button>
      </div>
      <div class="row">
        <div class="left">
          <div style="height:200px;border-radius:8px;background:#fafbff;display:flex;align-items:center;justify-content:center;font-size:20px;font-weight:700;margin-bottom:12px" id="mThumb">IMAGEN</div>
          <div id="mDesc" class="small" style="line-height:1.4"></div>
        </div>
        <div class="right">
          <div style="display:flex;flex-direction:column;gap:10px">
            <div><span class="small">Código</span><div id="mCode" style="font-weight:700"></div></div>
            <div><span class="small">Categoría</span><div id="mCat" class="small" style="font-weight:700;color:var(--accent)"></div></div>
            <div style="margin-top:10px">
              <a id="waBtn" class="whatsapp-btn" href="#" target="_blank" rel="noopener">Consultar por WhatsApp</a>
            </div>
            <div style="margin-top:12px" class="small">* Este es un demo. En producción el botón puede incluir cantidad y más parámetros.</div>
          </div>
        </div>
      </div>
    </div>
  </div>

<script>
/* ====== DEMO: datos simulados ======
   Reemplaza `products` por fetch('/data') en producción.
*/
const products = [
  // aquí pones objetos reales; dejo 10 de ejemplo para la demo
  {id:1, code:"GN-001", name:"Guante Nitrilo - M", category:"Guantes", desc:"Guante nitrilo, sin polvo. Empaque x100", img:"", stock:120},
  {id:2, code:"GN-002", name:"Guante Nitrilo - L", category:"Guantes", desc:"Guante nitrilo, sin polvo. Empaque x100", img:"", stock:80},
  {id:3, code:"J-101", name:"Jeringa 5ml", category:"Jeringas", desc:"Jeringa estéril 5ml con aguja", img:"", stock:500},
  {id:4, code:"EQ-210", name:"Oxímetro de Pulso", category:"Equipos", desc:"Medición de SpO2 y pulso. Uso clínico.", img:"", stock:10},
  {id:5, code:"H-11", name:"Alcohol en Gel 500ml", category:"Higiene", desc:"Alcohol en gel 70% para manos", img:"", stock:200},
  {id:6, code:"S-23", name:"Mascarilla Quirúrgica 3 capas", category:"Protección", desc:"Mascarilla desechable 3 capas", img:"", stock:1000},
  {id:7, code:"D-55", name:"Dermoguante - Talla S", category:"Guantes", desc:"Guante para procedimientos dermatológicos", img:"", stock:50},
  {id:8, code:"E-77", name:"Termómetro Infrarrojo", category:"Equipos", desc:"Termómetro sin contacto", img:"", stock:25},
  {id:9, code:"J-102", name:"Jeringa 10ml", category:"Jeringas", desc:"Jeringa estéril 10ml", img:"", stock:300},
  {id:10, code:"H-22", name:"Toallas Antisépticas", category:"Higiene", desc:"Toallas húmedas antisépticas", img:"", stock:180}
];
// FIN datos demo

// estado
let filtered = products.slice();
const categories = Array.from(new Set(products.map(p => p.category))).sort();

// DOM refs
const grid = document.getElementById('grid');
const searchInput = document.getElementById('searchInput');
const categorySelect = document.getElementById('categorySelect');
const countSpan = document.getElementById('count');
const modalBack = document.getElementById('modalBack');
const closeModal = document.getElementById('closeModal');
const mTitle = document.getElementById('mTitle');
const mThumb = document.getElementById('mThumb');
const mDesc = document.getElementById('mDesc');
const mCode = document.getElementById('mCode');
const mCat = document.getElementById('mCat');
const waBtn = document.getElementById('waBtn');

// poblar categorias
(function populateCategories(){
  categories.forEach(cat=>{
    const opt = document.createElement('option');
    opt.value = cat;
    opt.textContent = cat;
    categorySelect.appendChild(opt);
  });
})();

// render
function renderList(list){
  grid.innerHTML = '';
  countSpan.textContent = list.length;
  if(!list.length){
    grid.innerHTML = '<div style="grid-column:1/-1;padding:28px;background:#fff;border-radius:10px;text-align:center">No se encontraron productos</div>';
    return;
  }
  list.forEach(p=>{
    const card = document.createElement('div');
    card.className = 'card';
    card.tabIndex = 0;
    card.innerHTML = `
      <div class="thumb">${p.name.split(' ').slice(0,3).join(' ')}</div>
      <div style="flex:1">
        <div class="meta"><div class="name">${p.name}</div><div class="cat">${p.category}</div></div>
        <div style="margin-top:8px"><div class="small">${p.desc}</div></div>
      </div>
    `;
    card.addEventListener('click',()=> openModal(p));
    card.addEventListener('keypress',(e)=>{ if(e.key==='Enter') openModal(p) });
    grid.appendChild(card);
  });
}

// búsqueda + filtro
function applyFilters(){
  const q = searchInput.value.trim().toLowerCase();
  const cat = categorySelect.value;
  filtered = products.filter(p=>{
    const inCat = !cat || p.category === cat;
    if(!q) return inCat;
    const hay = (p.name+' '+p.code+' '+p.desc).toLowerCase();
    return inCat && hay.includes(q);
  });
  renderList(filtered);
}

// modal lógica
function openModal(p){
  mTitle.textContent = p.name;
  mThumb.textContent = p.code;
  mDesc.textContent = p.desc + `\n\nStock disponible: ${p.stock}`;
  mCode.textContent = p.code;
  mCat.textContent = p.category;
  // Mensaje de WhatsApp (personalizalo)
  const waMessage = encodeURIComponent(`Hola, quiero consultar por *${p.name}* (código: ${p.code}). ¿Está disponible?`);
  // Número de ejemplo: reemplazar con número real (prefijo internacional sin +, ej: 595XXXXXXXX)
  const phone = "595981000000"; // <-- cambialo por el número real
  waBtn.href = `https://wa.me/${phone}?text=${waMessage}`;
  modalBack.style.display = 'flex';
  modalBack.setAttribute('aria-hidden','false');
}

function closeModalFn(){
  modalBack.style.display = 'none';
  modalBack.setAttribute('aria-hidden','true');
}

closeModal.addEventListener('click', closeModalFn);
modalBack.addEventListener('click', (e)=>{ if(e.target === modalBack) closeModalFn(); });
document.addEventListener('keydown',(e)=>{ if(e.key==='Escape') closeModalFn(); });

// eventos búsqueda
searchInput.addEventListener('input', ()=> { applyFilters(); });
categorySelect.addEventListener('change', ()=> { applyFilters(); });

// render inicial
renderList(products);
</script>
</body>
</html>
